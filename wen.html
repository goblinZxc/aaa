<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
<script src="jquery.js"></script>
<style>
	div{background: red;width: 100px;height: 100px;}
    .box{width: 500px;height: 500px;border: 1px solid red;overflow:hidden;position: relative;padding-right: 30px;margin: 0 auto;}
    .content{width: 500px;height: auto;background: #ccc;padding: 10px 15px;}
    .scrollbar{width: 15px;height: 100%;position: absolute;right:0;top:0;background: yellow;border-radius: 15px;}
    .scrollbtn{width: 15px;background: blue;border-radius: 15px;}


</style>
</head>
<body>
	<!-- <div></div> -->
	<div class="box">
		<div class="content">
			运行这个函数将变量$的控制权让渡给第一个实现它的那个库。

这有助于确保jQuery不会与其他库的$对象发生冲突。 在运行这个函数后，就只能使用jQuery变量访问jQuery对象。例如，在要用到$("div p")的地方，就必须换成jQuery("div p")。 '''注意:'''这个函数必须在你导入jQuery文件之后，并且在导入另一个导致冲突的库'''之前'''使用。当然也应当在其他冲突的库被使用之前，除非jQuery是最后一个导入的。
恢复使用别名$，然后创建并执行一个函数，在这个函数的作用域中仍然将$作为jQuery的别名来使用。在这个函数中，原来的$对象是无效的。这个函数对于大多数不依赖于其他库的插件都十分有效。

jQuery 代码:
运行这个函数将变量$的控制权让渡给第一个实现它的那个库。

这有助于确保jQuery不会与其他库的$对象发生冲突。 在运行这个函数后，就只能使用jQuery变量访问jQuery对象。例如，在要用到$("div p")的地方，就必须换成jQuery("div p")。 '''注意:'''这个函数必须在你导入jQuery文件之后，并且在导入另一个导致冲突的库'''之前'''使用。当然也应当在其他冲突的库被使用之前，除非jQuery是最后一个导入的。
恢复使用别名$，然后创建并执行一个函数，在这个函数的作用域中仍然将$作为jQuery的别名来使用。在这个函数中，原来的$对象是无效的。这个函数对于大多数不依赖于其他库的插件都十分有效。

jQuery 代码:
运行这个函数将变量$的控制权让渡给第一个实现它的那个库。

这有助于确保jQuery不会与其他库的$对象发生冲突。 在运行这个函数后，就只能使用jQuery变量访问jQuery对象。例如，在要用到$("div p")的地方，就必须换成jQuery("div p")。 '''注意:'''这个函数必须在你导入jQuery文件之后，并且在导入另一个导致冲突的库'''之前'''使用。当然也应当在其他冲突的库被使用之前，除非jQuery是最后一个导入的。
恢复使用别名$，然后创建并执行一个函数，在这个函数的作用域中仍然将$作为jQuery的别名来使用。在这个函数中，原来的$对象是无效的。这个函数对于大多数不依赖于其他库的插件都十分有效。

jQuery 代码:
运行这个函数将变量$的控制权让渡给第一个实现它的那个库。

这有助于确保jQuery不会与其他库的$对象发生冲突。 在运行这个函数后，就只能使用jQuery变量访问jQuery对象。例如，在要用到$("div p")的地方，就必须换成jQuery("div p")。 '''注意:'''这个函数必须在你导入jQuery文件之后，并且在导入另一个导致冲突的库'''之前'''使用。当然也应当在其他冲突的库被使用之前，除非jQuery是最后一个导入的。
恢复使用别名$，然后创建并执行一个函数，在这个函数的作用域中仍然将$作为jQuery的别名来使用。在这个函数中，原来的$对象是无效的。这个函数对于大多数不依赖于其他库的插件都十分有效。

jQuery 代码:

运行这个函数将变量$的控制权让渡给第一个实现它的那个库。

这有助于确保jQuery不会与其他库的$对象发生冲突。 在运行这个函数后，就只能使用jQuery变量访问jQuery对象。例如，在要用到$("div p")的地方，就必须换成jQuery("div p")。 '''注意:'''这个函数必须在你导入jQuery文件之后，并且在导入另一个导致冲突的库'''之前'''使用。当然也应当在其他冲突的库被使用之前，除非jQuery是最后一个导入的。
恢复使用别名$，然后创建并执行一个函数，在这个函数的作用域中仍然将$作为jQuery的别名来使用。在这个函数中，原来的$对象是无效的。这个函数对于大多数不依赖于其他库的插件都十分有效。

jQuery 代码:
运行这个函数将变量$的控制权让渡给第一个实现它的那个库。

这有助于确保jQuery不会与其他库的$对象发生冲突。 在运行这个函数后，就只能使用jQuery变量访问jQuery对象。例如，在要用到$("div p")的地方，就必须换成jQuery("div p")。 '''注意:'''这个函数必须在你导入jQuery文件之后，并且在导入另一个导致冲突的库'''之前'''使用。当然也应当在其他冲突的库被使用之前，除非jQuery是最后一个导入的。
恢复使用别名$，然后创建并执行一个函数，在这个函数的作用域中仍然将$作为jQuery的别名来使用。在这个函数中，原来的$对象是无效的。这个函数对于大多数不依赖于其他库的插件都十分有效。
jQuery 代码:
运行这个函数将变量$的控制权让渡给第一个实现它的那个库。

这有助于确保jQuery不会与其他库的$对象发生冲突。 在运行这个函数后，就只能使用jQuery变量访问jQuery对象。例如，在要用到$("div p")的地方，就必须换成jQuery("div p")。 '''注意:'''这个函数必须在你导入jQuery文件之后，并且在导入另一个导致冲突的库'''之前'''使用。当然也应当在其他冲突的库被使用之前，除非jQuery是最后一个导入的。
恢复使用别名$，然后创建并执行一个函数，在这个函数的作用域中仍然将$作为jQuery的别名来使用。在这个函数中，原来的$对象是无效的。这个函数对于大多数不依赖于其他库的插件都十分有效。
jQuery 代码:
运行这个函数将变量$的控制权让渡给第一个实现它的那个库。

这有助于确保jQuery不会与其他库的$对象发生冲突。 在运行这个函数后，就只能使用jQuery变量访问jQuery对象。例如，在要用到$("div p")的地方，就必须换成jQuery("div p")。 '''注意:'''这个函数必须在你导入jQuery文件之后，并且在导入另一个导致冲突的库'''之前'''使用。当然也应当在其他冲突的库被使用之前，除非jQuery是最后一个导入的。
恢复使用别名$，然后创建并执行一个函数，在这个函数的作用域中仍然将$作为jQuery的别名来使用。在这个函数中，原来的$对象是无效的。这个函数对于大多数不依赖于其他库的插件都十分有效。jQuery 代码:
运行这个函数将变量$的控制权让渡给第一个实现它的那个库。

这有助于确保jQuery不会与其他库的$对象发生冲突。 在运行这个函数后，就只能使用jQuery变量访问jQuery对象。例如，在要用到$("div p")的地方，就必须换成jQuery("div p")。 '''注意:'''这个函数必须在你导入jQuery文件之后，并且在导入另一个导致冲突的库'''之前'''使用。当然也应当在其他冲突的库被使用之前，除非jQuery是最后一个导入的。
恢复使用别名$，然后创建并执行一个函数，在这个函数的作用域中仍然将$作为jQuery的别名来使用。在这个函数中，原来的$对象是无效的。这个函数对于大多数不依赖于其他库的插件都十分有效。

jQuery 代码:


		</div>
		<div class="scrollbar">
			<div class="scrollbtn"></div>
		</div>
	</div>
</body>
<script>
    // var j=jQuery.noConflict();
    //方法一
	// alert(j);
    // (function($){
    	//这里的$可以是a,b等任意变量
    	// alert($);
    // })(jQuery);
    //方法二
    //自调用变成局部变量不会影响全局中的$,习惯于用$;


    //高度不确定，与内容成一定的比例：滚动条按钮：滚动条=当前容器的高度：内部容器的高度
    var bh=$(".box").height();
    var ch=$(".content").innerHeight();
    var bl=bh/ch;
    $(".scrollbtn").height(function(){
          return bl*bh;
          //此处可不用写回调函数
    })
    $(".scrollbtn").mousedown(function(e){
        //$(".box").mousedown({function(){alert(1);}})
        //$(".box").mousedown({function(){alert(2);}})
        // 可同时实现，on(click)的形式也是一样，所以不容易移除，用.on .off较方便
        //普通添加的事件也可用off直接移除
        // on("mousedown",fn1);
        // function fn1(){alert(1)};
        //  on("mousedown",fn2);
        // function fn2(){alert(2)};
        // off("mousedown",fn1);单独移除
             var cy=e.clientY;
             // console.log(cy);
             var oldmt=$(".scrollbtn").css("margin-top")
             oldmt=parseInt(oldmt);
             // console.log(oldmt);
             $(".box").on("mousedown",function(e){
             	e.preventDefault();
             })
             //阻止浏览器默认行为在滚轮的过程中选中文本
             var doc=$(document);
             doc.on("mousemove",function(e){
                var ny=e.clientY;
                // console.log(ny);
                var mt=ny-cy+oldmt;
                if(mt<=0){
                	mt=0;
                }
                if(mt>=bh-bl*bh){
                	mt=bh-bl*bh;
                }
                $(".scrollbtn").css("margin-top",mt);
                $(".content").css("margin-top",-mt/bl);
             })
          doc.on("mouseup",function(){
          	  doc.off("mousemove mouseup");
          	  $(".box").off("mousedown");
          })
    })

    //滚动
    $.fn.extend({mousewheel:function(upcall,downcall){      
            if(this[0].addEventListener){
                // console.log(this);获取转化为一个原生对象
              this[0].addEventListener("mousewheel",fn,false);
              this[0].addEventListener("DOMMousewheel",fn,false);
            }else{this[0].attachEvent("onmousewheel",fn);
            }

        function fn(e){
            var ev=e||window.event;
            if(ev.preventDefault()){
                ev.preventDefault()
            }else{
                ev.returnValue=false;} 
            var data=ev.detail||ev.wheelDelta;
            if(data==-3||data==120){
              upcall();
            }else{
              downcall();
            }

        }
   }
})
   var num=20;
   $(".box").mousewheel(function(){
             // console.log($(".scrollbtn"));
             var top=parseInt($(".scrollbtn").css("margin-top"));
             top-=num;
             if(top<0){
                top=0;
             }
             $(".scrollbtn").css("margin-top",top);
             $(".content").css("margin-top",-top/bl);
        },function(){
             var top=parseInt($(".scrollbtn").css("margin-top"));
             top+=num;
             if(top>=bh-bl*bh){
                 top=bh-bl*bh;
                }
             $(".scrollbtn").css("margin-top",top);
             $(".content").css("margin-top",-top/bl);
   })
</script>
</html>